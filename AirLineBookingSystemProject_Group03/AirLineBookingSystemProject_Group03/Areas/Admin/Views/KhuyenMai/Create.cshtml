@model AirLineBookingSystemProject_Group03.Models.KHUYENMAI

@{
    ViewBag.Title = "Thêm Khuyến Mãi";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
}

<div class="container mt-4" style="max-width: 900px;">
    <div class="card shadow border-0 rounded-3">
        <div class="card-header bg-success text-white py-3" style="background: linear-gradient(135deg, #198754, #146c43);">
            <h5 class="m-0 fw-bold text-uppercase"><i class="fas fa-plus-circle me-2"></i> THIẾT LẬP MÃ KHUYẾN MÃI</h5>
        </div>

        <div class="card-body p-4 bg-white">
            @using (Html.BeginForm())
            {
                @Html.AntiForgeryToken()
                @Html.ValidationSummary(true, "", new { @class = "alert alert-danger" })

                <div class="row">
                    <div class="col-md-6 border-end">
                        <h6 class="text-success fw-bold mb-3 border-bottom pb-2"><i class="fas fa-info-circle me-1"></i> Thông tin chung</h6>

                        <div class="mb-3">
                            <label class="form-label fw-bold">Mã Code (ID) <span class="text-danger">*</span></label>
                            @Html.EditorFor(model => model.ID, new { htmlAttributes = new { @class = "form-control text-uppercase fw-bold text-primary", placeholder = "VD: HE2025, TET...", maxlength = "20" } })
                            @Html.ValidationMessageFor(model => model.ID, "", new { @class = "text-danger small" })
                            <small class="text-muted">Mã này khách hàng sẽ nhập khi thanh toán.</small>
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-bold">Mô tả chi tiết</label>
                            @Html.TextAreaFor(model => model.MOTA, new { @class = "form-control", rows = "3", placeholder = "VD: Giảm 10% cho vé hạng thương gia..." })
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-bold">Số lượng phát hành</label>
                            @Html.EditorFor(model => model.SOLUONG, new { htmlAttributes = new { @class = "form-control", type = "number", min = "1", Value = "100" } })
                        </div>
                    </div>

                    <div class="col-md-6 ps-md-4">
                        <h6 class="text-success fw-bold mb-3 border-bottom pb-2"><i class="fas fa-tag me-1"></i> Giá trị & Thời hạn</h6>

                        <div class="mb-3">
                            <label class="form-label fw-bold">Loại khuyến mãi</label>
                            <select class="form-select fw-bold" id="LoaiKhuyenMai" name="LOAIKHUYENMAI" onchange="toggleHint()">
                                <option value="SoTien">Giảm theo Số Tiền (VNĐ)</option>
                                <option value="PhanTram">Giảm theo Phần Trăm (%)</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-bold">Giá trị giảm</label>
                            @Html.EditorFor(model => model.GIATRI, new { htmlAttributes = new { @class = "form-control fw-bold text-danger", type = "number", step = "0.01" } })
                            <small class="text-muted fst-italic" id="valueHint">Nhập số tiền VNĐ (VD: 50000)</small>
                            @Html.ValidationMessageFor(model => model.GIATRI, "", new { @class = "text-danger small" })
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-bold">Giảm tối đa (Nếu là %)</label>
                            @Html.EditorFor(model => model.GIATRITOIDA, new { htmlAttributes = new { @class = "form-control", placeholder = "Bỏ trống nếu không giới hạn" } })
                        </div>

                        <div class="row">
                            <div class="col-6 mb-3">
                                <label class="form-label fw-bold">Ngày bắt đầu</label>
                                <input type="date" name="NGAYBATDAU" class="form-control" required value="@DateTime.Today.ToString("yyyy-MM-dd")" />
                            </div>
                            <div class="col-6 mb-3">
                                <label class="form-label fw-bold">Ngày kết thúc</label>
                                <input type="date" name="NGAYKETTHUC" class="form-control" required />
                                @Html.ValidationMessageFor(model => model.NGAYKETTHUC, "", new { @class = "text-danger small" })
                            </div>
                        </div>
                    </div>
                </div>

                <div class="d-flex justify-content-center gap-3 mt-4 pt-3 border-top">
                    <a href="@Url.Action("Index")" class="btn btn-outline-secondary px-4 fw-bold">
                        <i class="fas fa-arrow-left me-2"></i> Quay lại
                    </a>
                    <button type="submit" class="btn btn-success px-5 fw-bold shadow">
                        <i class="fas fa-save me-2"></i> LƯU MÃ KHUYẾN MÃI
                    </button>
                </div>
            }
        </div>
    </div>
</div>

<script>
    function toggleHint() {
        var type = document.getElementById("LoaiKhuyenMai").value;
        var hint = document.getElementById("valueHint");

        if (type === "PhanTram") {
            hint.innerHTML = "<span class='text-danger fw-bold'><i class='fas fa-exclamation-triangle'></i> Lưu ý: Nhập số thập phân (VD: 0.1 = 10%, 0.5 = 50%)</span>";
        } else {
            hint.innerText = "Nhập số tiền VNĐ (VD: 50000)";
        }
    }
</script>